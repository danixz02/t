<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gravação de Tela</title>
</head>
<body>
    <button id="startScreenRecordingButton">Iniciar Gravação de Tela</button>
    <button id="stopScreenRecordingButton" disabled>Parar Gravação de Tela</button>
    
    <video id="screenRecording" autoplay controls style="display:none;"></video>
    
    <script>
        var startScreenRecordingButton = document.getElementById('startScreenRecordingButton');
        var stopScreenRecordingButton = document.getElementById('stopScreenRecordingButton');
        var screenRecordingVideo = document.getElementById('screenRecording');
        var mediaRecorder;
        var recordedChunks = [];
        
        startScreenRecordingButton.onclick = function() {
            startScreenRecordingButton.disabled = true;
            stopScreenRecordingButton.disabled = false;
            recordedChunks = [];
            
            var constraints = { video: { mediaSource: 'screen' } };
            
            navigator.mediaDevices.getUserMedia(constraints)
                .then(function(stream) {
                    screenRecordingVideo.srcObject = stream;
                    
                    try {
                        mediaRecorder = new MediaRecorder(stream);
                    } catch (e) {
                        console.error('Erro ao criar MediaRecorder:', e);
                        return;
                    }
                    
                    mediaRecorder.ondataavailable = function(event) {
                        if (event.data.size > 0) {
                            recordedChunks.push(event.data);
                        }
                    };
                    
                    mediaRecorder.onstop = function() {
                        var blob = new Blob(recordedChunks, { type: 'video/webm' });
                        var url = URL.createObjectURL(blob);
                        var a = document.createElement('a');
                        a.href = url;
                        a.download = 'screen_recording.webm';
                        document.body.appendChild(a);
                        a.click();
                        setTimeout(function() {
                            document.body.removeChild(a);
                            URL.revokeObjectURL(url);
                        }, 100);
                    };
                    
                    mediaRecorder.start();
                })
                .catch(function(error) {
                    console.error('Erro ao capturar a tela:', error);
                    startScreenRecordingButton.disabled = false;
                    stopScreenRecordingButton.disabled = true;
                });
        };
        
        stopScreenRecordingButton.onclick = function() {
            startScreenRecordingButton.disabled = false;
            stopScreenRecordingButton.disabled = true;
            mediaRecorder.stop();
        };
    </script>
</body>
</html>
